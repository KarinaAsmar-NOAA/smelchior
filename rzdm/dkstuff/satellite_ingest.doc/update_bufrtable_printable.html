<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
<head>
  <title>How to Implement BUFR Table Changes for Satellte Ingest Types
- Printable Version</title>
  <meta http-equiv="Content-Type"
 content="text/html; charset=windows-1252">
  <link href="/cwi/main.css" type="text/css" rel="stylesheet">
  <link rel="icon" type="image/ico"
 href="http://www.nco.ncep.noaa.gov/cwi/favicon.ico">
</head>
<body leftmargin="0" topmargin="0" rightmargin="0"
 style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); background-image: url(#ffffff);"
 alink="#000099" link="#000099" marginheight="0" marginwidth="0"
 vlink="#990099">
<!-- Begin Content Body-->
<table summary="Table is for layout only." align="center" border="0"
 cellpadding="4" cellspacing="0" width="600">
  <tbody>
    <tr valign="top">
      <td valign="top" width="540"> <a name="contents"> <img
 src="/images/icon_printer.gif" alt="Printer image icon." border="0"
 height="16" width="16"> </a><small><a target="_top"
 href="javascript:window.print();">Send
To Printer</a></small>
      <hr>
      <pre> <br><br><br> <br><br></pre>
      <center>
      <h2 align="center">How
to
Implement BUFR Table Changes for Satellite Ingest Types</h2>
      </center>
      <h3 style="text-align: center;">(bufrtab.003,
bufrtab.005, bufrtab.008, bufrtab.012 and&nbsp;bufrtab.021)<br>
      </h3>
      <div style="text-align: center;"></div>
      <h3 style="text-align: center;">Dennis
Keyser -
NOAA/NWS/NCEP/EMC <br>
(Last Revised 11/27/2017)</h3>
      <pre><h2 align="center"></h2><br><p>Please take a moment to read the <a
 href="http://weather.gov/disclaimer.php" target="_blank"><span
 style="color: rgb(0, 0, 255);">Disclaimer</span></a> for this non-operational web page.<br>&nbsp; </p><p><small><i>NOTE: Links open in a new window</i></small></p><p></p><pre><hr
 width="75%"></pre><span style="font-weight: bold;">IMPORTANT</span>: All&nbsp;BUFR tables associated with the subtypes generated by&nbsp;the satellite<br>ingest are now separate and distinct from those associated with the&nbsp;NCO decoder<br>processing. Thus any changes to the satellite ingest BUFR tables have no affect on<br>NCO decoder processing. See<br><a
 href="http://www2.nco.ncep.noaa.gov/sib/decoders/Administrator/index.shtml"
 target="_blank"><span style="color: rgb(0, 0, 255);">http://www2.nco.ncep.noaa.gov/sib/decoders/Administrator/index.shtml</span></a> for instructions<br>on implementing BUFR table changes to BUFR tables associated with NCO decoder processing.<br><span
 style="font-weight: bold;">(Note to NCO/SIB: Please remove all references to satellite ingest in </span><a
 style="color: rgb(0, 0, 255); font-weight: bold;"
 href="http://www2.nco.ncep.noaa.gov/sib/decoders/Administrator/index.shtml"
 target="_blank">this web&nbsp;</a><a
 style="color: rgb(0, 0, 255); font-weight: bold;"
 href="http://www2.nco.ncep.noaa.gov/sib/decoders/Administrator/index.shtml"
 target="_blank">page</a><span style="font-weight: bold;">.)<br><br
 clear="all"></span><hr width="75%"><br><b>PLEASE NOTE:</b> When changing BUFR tables <span
 style="color: rgb(0, 0, 255);"><span style="color: rgb(0, 0, 255);"><span
 style="font-family: Arial; color: rgb(0, 0, 0);"></span></span></span>for satellite ingest data types,, complete the<br>following procedure in its entirety on each WCOSS machine in which the satellite ingest<br>is running and filling BUFR tanks in /dcom.<br><br><hr
 width="75%"><br><p></p><pre><span style="font-family: Courier New;">BUFR table changes add an extra degree of complexity to an implementation, because the<br>BUFR tables are used as a definitive layout of the contents of a particular BUFR type/<br>subtype. Specifically, the same BUFR table that is used by a</span> <span
 style="font-family: Courier New;">WCOSS satellite ingest<br>job&nbsp;to encode a particular type of observation into</span> <span
 style="font-family: Courier New;">BUFR is also used by the subsequent<br></span><span
 style="font-weight: bold; font-family: Courier New;">tranjb</span><span
 style="font-family: Courier New;">&nbsp;process to append those same observations to the BUFR files for that type within<br>the BUFR database /dcom/us007003. So whenever</span> <span
 style="font-family: Courier New;">the BUFR table is changed for a particular<br>type/subtype, a copy of the new table needs</span> <span
 style="font-family: Courier New;">to be written into all of the satellite<br>ingest BUFR files for that type/subtype within the database, at the point directly<br>before which observations encoded according to the</span> <span
 style="font-family: Courier New;">new table will begin to be appended<br>to each file. Applications which read these satellite ingest database files will then<br>respond to the new table and adjust accordingly to the new layout definition as they<br>continue reading through the files.</span></pre><p><br></p><pre>Note that, while one might assume that it would only be&nbsp;technically necessary to write a<br>copy of the new table to files of the actual type/subtype(s) which are changing, one<br>cannot guarantee 100% success in subsequent&nbsp;<span
 style="font-weight: bold;">tranjb </span>processing unless&nbsp;a copy of the new<br>table is appended to&nbsp;all satellite ingest files in the database which use the same<br>table. In other words, if, e.g.,&nbsp;a change is being made to type/subtype b021/xx201<br>within bufrtab.021, one should&nbsp;update <i>all </i>satellite ingest files of type b021 within the<br>database,&nbsp;not just the xx201 files. The reason for this is two-fold. First, it is<br>possible that a change to the BUFR table&nbsp;for a particular BUFR type could cause <span
 style="font-weight: bold;">tranjb</span><br>to fail when processing compressed BUFR messages for this BUFR type, even for&nbsp;subtypes<br>other than those modified in the table (if the new table is not copied into these<br>files). Second, even if <span
 style="font-weight: bold;">tranjb </span>processing is successful in this case, it is possible<br>that downstream <span
 style="font-weight: bold;">dumpjb </span>processing could fail, again even for subtypes other than those<br>modified in the table (if the new table is not copied into these files).</pre><p><br></p><pre><span
 style="font-family: Courier New;">Here is the&nbsp;procedure to follow for updating satellite ingest files in the database</span> <span
 style="font-family: Courier New;">when<br>a BUFR table change is&nbsp;being implemented:</span></pre><ol><br><li><pre>Suspend, via ECflow,&nbsp;the satellite ingest job(s) that encode data into the&nbsp;tankfiles<br
 clear="all">in the database for the BUFR table being implemented.</pre><pre><ul
 style="font-family: Courier New;"><li><pre>For changes to bufrtab.003, current&nbsp;jobs to suspend are: JIGOES_RADSND and <br
 clear="all">JITOV.</pre></li><li><pre>For changes to bufrtab.005, current job to suspend is:&nbsp;JISWD.</pre></li><li><pre>For changes to bufrtab.008, current jobs to suspend are: JIOZONE_ORBIT,<br
 clear="all">JIAEROSOL and JINPP. </pre></li><li><pre>For changes to bufrtab.012, current jobs to suspend are: JIGOES_RADSND,<br
 clear="all">JIGOES_SST, JIPOES_SST,&nbsp;JIQST and JISMI.</pre></li><li><pre>For changes to bufrtab.021, current&nbsp;jobs to suspend are: JIAIRS, JIAVHRR,<br
 clear="all">JIGOES_RADSND, JINPP, JINPP_ATMS, JINPP_CRIS_2211, JINPP_CRIS_431, JISMI and<br
 clear="all">JITOV.</pre></li></ul></pre><p><br clear="all"></p></li><li><pre><span
 style="color: rgb(0, 0, 255);"></span><span style="font-style: italic;">(no longer applicable - skip to item 3 </span><span
 style="font-family: monospace; font-style: italic;">b</span><span
 style="font-style: italic;">elow)</span><span
 style="color: rgb(0, 0, 255);"></span></pre></li><br><li><pre>At this point, it is now safe to cd to the BUFR table directory<br
 clear="all"><span style="font-family: mon;"><span
 style="font-family: monospace;"></span><span style="font-weight: bold;"></span></span><span
 style="font-weight: bold;">/nwprod/obsproc_satingest.vX.Y.Z/fix </span>(where&nbsp;<span
 style="font-weight: bold;">X.Y.Z</span> is the latest version of <br>obsproc_satingest) and actually copy the new version of the BUFR table from the<br
 clear="all">user work area into this directory. This is also the time to implement any other<br>changes to the underlying satellite ingest processing (i.e. new executables, new<br>scripts, etc.) by copying them into their proper respective locations within<br
 clear="all"><b>/nwprod</b>.<br><span style="font-family: Courier New;"></span></pre></li><br><li><pre><span
 style="font-style: italic;">(no longer applicable - skip to item 6 below)</span><span
 style="font-family: Courier New; font-style: italic;"></span><br></pre><p><br
 clear="all"></p></li><li><pre><span style="font-style: italic;">(no longer applicable - skip to item 6 below)</span><a
 href="http://www2.nco.ncep.noaa.gov/sib/decoders/Administrator/index.shtml"
 target="_blank"><span style="color: rgb(0, 0, 255);"></span></a><br
 clear="all"></pre></li><br><li><pre><span
 style="font-family: Courier New;">We are now ready to update the satellite ingest database with the new table. We</span><br
 clear="all"><span style="font-family: Courier New;">need to update all of the satellite ingest-generated tanks in the database</span><br
 clear="all"><span style="font-family: Courier New;">corresponding to that BUFR table.</span><span
 style="font-family: Courier New;"></span><span
 style="font-family: Courier New;"></span><br clear="all"></pre><ul
 style="font-family: Courier New;"><pre><li><pre>For changes to bufrtab.003,&nbsp;use:&nbsp;<br><span
 style="font-weight: bold; color: rgb(255, 0, 0);">$ export APXDX_TYPE=satingest</span><br
 style="font-weight: bold; color: rgb(255, 0, 0);" clear="all"><span
 style="font-weight: bold; color: rgb(255, 0, 0);">$ </span><span
 style="font-weight: bold; color: rgb(255, 0, 0);">/nwprod/util/ush/run_apxdx.sh</span><span
 style="font-weight: bold; color: rgb(255, 0, 0);"> /dcom/us007003 \</span><br
 clear="all"><span style="font-weight: bold; color: rgb(255, 0, 0);">  /nwprod/obsproc_satingest.v<span
 style="color: rgb(0, 0, 0);">X.Y.Z</span>/fix/bufrtab.003</span><br
 clear="all"><small style="color: rgb(0, 0, 0);">(where X.Y.Z is latest version of obsproc_satingest containing updated bufrtab.003)</small></pre></li><li><pre>For changes to bufrtab.005, use:<br><span
 style="font-weight: bold; color: rgb(255, 0, 0);">$ export APXDX_TYPE=satingest</span><br
 style="font-weight: bold; color: rgb(255, 0, 0);" clear="all"><span
 style="font-weight: bold; color: rgb(255, 0, 0);">$ </span><span
 style="font-weight: bold; color: rgb(255, 0, 0);">/nwprod/util/ush/run_apxdx.sh</span><span
 style="font-weight: bold; color: rgb(255, 0, 0);"> /dcom/us007003 \<br>  /nwprod/obsproc_satingest.v<span
 style="color: rgb(0, 0, 0);">X.Y.Z</span>/fix/bufrtab.005<br></span><small><span
 style="color: rgb(255, 0, 0);"><span style="color: rgb(0, 0, 0);">(where <span
 style="font-weight: bold;">X.Y.Z</span> is latest version of obsproc_satingest containing updated bufrtab.005)</span></span></small></pre></li><li><pre>For changes to bufrtab.008,&nbsp;use:<br><span
 style="font-weight: bold; color: rgb(255, 0, 0);">$ export APXDX_TYPE=satingest</span><br
 style="font-weight: bold; color: rgb(255, 0, 0);" clear="all"><span
 style="font-weight: bold; color: rgb(255, 0, 0);">$ </span><span
 style="font-weight: bold; color: rgb(255, 0, 0);">/nwprod/util/ush/run_apxdx.sh</span><span
 style="font-weight: bold; color: rgb(255, 0, 0);"> /dcom/us007003 \</span><br
 clear="all"><span style="font-weight: bold; color: rgb(255, 0, 0);">  /nwprod/obsproc_satingest.v<span
 style="color: rgb(0, 0, 0);">X.Y.Z</span>/fix/bufrtab.008</span><br
 clear="all"><small><span style="color: rgb(255, 0, 0);"><span
 style="color: rgb(0, 0, 0);">(where <span style="font-weight: bold;">X.Y.Z</span> is latest version of obsproc_satingest containing updated bufrtab.008)</span></span></small></pre></li><li><pre>For changes to bufrtab.012,&nbsp;use:<br><span
 style="font-weight: bold; color: rgb(255, 0, 0);">$ export APXDX_TYPE=satingest</span><br
 style="font-weight: bold; color: rgb(255, 0, 0);" clear="all"><span
 style="font-weight: bold; color: rgb(255, 0, 0);">$ </span><span
 style="font-weight: bold; color: rgb(255, 0, 0);">/nwprod/util/ush/run_apxdx.sh</span><span
 style="font-weight: bold; color: rgb(255, 0, 0);"> /dcom/us007003 \<br>  /nwprod/obsproc_satingest.v<span
 style="color: rgb(0, 0, 0);">X.Y.Z</span>/fix/bufrtab.012<br></span><small><span
 style="color: rgb(255, 0, 0);"><span style="color: rgb(0, 0, 0);">(where <span
 style="font-weight: bold;">X.Y.Z</span> is latest version of obsproc_satingest containing updated bufrtab.012)</span></span></small></pre></li><li><pre>For changes to bufrtab.021, use:<br
 clear="all"><span style="font-weight: bold; color: rgb(255, 0, 0);">$ export APXDX_TYPE=satingest</span><br
 style="font-weight: bold; color: rgb(255, 0, 0);" clear="all"><span
 style="font-weight: bold; color: rgb(255, 0, 0);">$ </span><span
 style="font-weight: bold; color: rgb(255, 0, 0);">/nwprod/util/ush/run_apxdx.sh</span><span
 style="font-weight: bold; color: rgb(255, 0, 0);"> /dcom/us007003 \</span><br
 clear="all"><span style="font-weight: bold; color: rgb(255, 0, 0);">  /nwprod/obsproc_satingest.v<span
 style="color: rgb(0, 0, 0);">X.Y.Z</span>/fix/bufrtab.021</span><br
 clear="all"><small><span style="color: rgb(255, 0, 0);"><span
 style="color: rgb(0, 0, 0);">(where <span style="font-weight: bold;">X.Y.Z</span> is latest version of obsproc_satingest containing updated bufrtab.021)</span></span></small></pre></li></pre></ul><pre><span
 style="font-family: Courier New;">In each case, the last&nbsp;command may take</span> <span
 style="font-family: Courier New;">several&nbsp;minutes&nbsp;to complete</span> <span
 style="font-family: Courier New;">depending on</span><br clear="all"><span
 style="font-family: Courier New;">the</span> <span
 style="font-family: Courier New;">number of </span><span
 style="font-family: Courier New;">tankfiles being updated within the database as well as their size</span><br
 clear="all"><span style="font-family: Courier New;">(some </span><span
 style="font-family: Courier New;">of </span><span
 style="font-family: Courier New;">the b021 files are very large), so be patient!</span></pre><p><br
 clear="all"></p></li><li><pre>The implementation is now complete and we are ready to turn back on, via ECflow,<br
 clear="all">the satellite ingest job(s)&nbsp;which had been&nbsp;suspended.</pre><p><br
 clear="all"></p></li><li><pre>Don't forget to notify the SDM, operators, etc. that the implementation has been<br
 clear="all">completed on this machine (i.e. tide or gyre), and don't forget to repeat the<br
 clear="all">above procedure on the other machine as well!</pre></li></ol></pre>
      <p> </p>
      <br>
      </td>
    </tr>
  </tbody>
</table>
<!-- End Content Body -->
</body>
</html>
